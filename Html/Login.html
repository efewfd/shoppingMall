<!DOCTYPE html>
<html>
    <head>
        <title>로그인</title>
        <link href="../Css/home.css" rel="stylesheet" />
        <link href="../Css/Login.css" rel="stylesheet" />
    </head>
    <body>
        <div class="Navbar">
            <h1 class="logo"><a href="home.html">Shopping Mall</a></h1>
            <ul class="products">
                <li>
                    <a href="./outerwear/outerwear.html">아우터</a>
                    <div class="sub-category">
                        <ul>
                            <li><a href="./outerwear/coat.html">코트</a></li>
                            <li><a href="./outerwear/jacket.html">자켓</a></li>
                            <li><a href="./outerwear/cardigan.html">가디건</a></li>
                            <li><a href="./outerwear/vest.html">조끼</a></li>
                        </ul>
                    </div>
                </li>
                <li>
                    <a href="./top/consultation.html">상의</a>
                    <div class="sub-category">
                        <ul>
                            <li><a href="./top/basic.html">기본</a></li>
                            <li><a href="./top/casual.html">캐주얼</a></li>
                            <li><a href="./top/sweatshirt.html">맨투맨</a></li>
                            <li><a href="./top/hoddie.html">후드티</a></li>
                            <li><a href="./top/shirt.html">셔츠</a></li>
                            <li><a href="./top/blouse.html">블라우스</a></li>
                        </ul>
                    </div>
                </li>
                <li>
                    <a href="./bottom/bottom.html">하의</a>
                    <div class="sub-category">
                        <ul>
                            <li><a href="./bottom/denim.html">데님</a></li>
                            <li><a href="./bottom/short.html">반바지</a></li>
                            <li><a href="./bottom/cotton.html">코튼</a></li>
                            <li><a href="./bottom/leggings.html">레깅스</a></li>
                        </ul>
                    </div>
                </li>
                <li>
                    <a href="./dress/dress.html">원피스</a>
                    <div class="sub-category">
                        <ul>
                            <li><a href="./dress/dress-min.html">미니</a></li>
                            <li><a href="./dress/dress-long.html">롱</a></li>
                        </ul>
                    </div>
                </li>
                <li>
                    <a href="./skirt/skirt.html">스커트</a>
                    <div class="sub-category">
                        <ul>
                            <li><a href="./skirt/skirt-min.html">미니</a></li>
                            <li><a href="./skirt/skirt-long.html">롱</a></li>
                        </ul>
                    </div>
                </li>
            </ul>
            <ul class="listbar">
            </ul>
        </div>
        <div class="login-page">
            <h2>Login</h2>
            <form id="login-form" class="login-form">
                <input class="Email" name="userId" placeholder="ID" type="text" required>
                <input class="Password" name="password" placeholder="Password" type="password" required>
                <label for="rememder-check">
                    <input class="checkbox" type="checkbox" id="rememder-check">아이디 기억하기
                </label>
                <button class="login-but" type="submit">
                    로그인
                </button>
            </form>

            <p class="SingUp-page"><a href="SignUp.html">Sign Up</a></p>
            <p class="find-links">
              <a href="find-id.html">아이디 찾기</a> | 
              <a href="find-password.html">비밀번호 찾기</a>
            </p>

        </div>
        <script>
            document.getElementById('login-form').addEventListener('submit', async (e) => {
                e.preventDefault();
                const form = e.target;

                const formData = new FormData(form);
                // const userId = formData.get('userId');
                // const password = formData.get('password');
                // const remember = document.getElementById('remember-check').checked;

                // '아이디 기억하기'가 체크되어 있으면 저장
                // if (remember) {
                //     localStorage.setItem('rememberedUserId', userId);
                // } else {
                //     localStorage.removeItem('rememberedUserId');
                // }

                const res = await fetch('/api/auth/login', {
                  method: 'POST',
                  body: formData
                });

                const data = await res.json();
                console.log('[로그인 응답]', data);

                if (res.ok) {
                  // 로그인 성공 시 사용자 정보 저장
                  localStorage.setItem("user", JSON.stringify(data));
                  localStorage.setItem("isLogin", "true");
                  localStorage.setItem('userId', data.user.userId);

                  alert('로그인 성공!');
                  window.location.href = '/home.html'; // 로그인 성공 시 홈으로 이동
                } else {
                  alert('로그인 실패: ' + data.message);
                }
            });

            // 페이지 열릴 때 localStorage에서 아이디 불러오기
            // window.addEventListener('DOMContentLoaded', () => {
            //     const rememberedUserId = localStorage.getItem('rememberedUserId');
            //     if (rememberedUserId) {
            //     document.querySelector('input[name="userId"]').value = rememberedUserId;
            //     document.getElementById('remember-check').checked = true;
            //     }
            // });
        </script>
        <script src="../js/navbar.js"></script>
    </body>
</html>